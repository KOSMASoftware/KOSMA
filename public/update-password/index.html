<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <title>Redirecting…</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f9fafb;
        color: #6b7280;
      }
    </style>
  </head>
  <body>
    <p>Loading secure environment...</p>
    <script>
      (function () {
        // Ziel: Alle Informationen aus der URL retten, egal ob sie vor oder nach dem Hash stehen.
        // E-Mail-Tracking-Systeme machen oft aus /pfad#token -> /pfad?tracking=123#token oder entfernen den Hash.
        
        const { hash, search } = window.location;

        // 1. Bereinigen: '#' und '?' am Anfang entfernen
        const h = hash ? hash.replace(/^#/, '') : '';
        const q = search ? search.replace(/^\?/, '') : '';

        // 2. Zusammenführen: Wir kleben Query und Hash mit '&' zusammen.
        // Das Ergebnis ist ein langer String mit allen Parametern (access_token, type, tracking_id etc.)
        const combined = [q, h].filter(Boolean).join('&');

        // 3. Ziel-URL bauen: Wir zwingen den Browser in die Hash-Route der React-App (/#/...)
        // Die Auth.tsx Komponente ist schlau genug, sich die Tokens aus dem Search-Teil zu regexen.
        const target = combined
          ? `/#/update-password?${combined}`
          : '/#/update-password';

        // 4. Weiterleitung
        window.location.replace(target);
      })();
    </script>
  </body>
</html>